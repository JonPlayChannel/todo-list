(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function o(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function n(l){if(l.ep)return;l.ep=!0;const c=o(l);fetch(l.href,c)}})();const s={toggleComplete:"[data-js-toggle-complete]",todoForm:"[data-js-todo-form]",todoInput:"[data-js-todo-input]",todoList:"[data-js-todo-list]",todoItem:"[data-js-todo-item]",todoItemLabel:"[data-js-todo-item-label]",todoItemCheckbox:"[data-js-todo-item-checkbox]",deleteTaskButton:"[data-js-delete-task-button]",todoFooter:"[data-js-todo-footer]",todoItemsCount:"[data-js-todo-items-count]",todoItemsLabel:"[data-js-todo-items-label]",todoItemsLeft:"[data-js-todo-items-left]",showAllTasksButton:"[data-js-show-all-tasks-button]",showActiveTasksButton:"[data-js-show-active-tasks-button]",showCompletedTasksButton:"[data-js-show-completed-tasks-button]",removeCompletedTasksButton:"[data-js-remove-completed-tasks-button]"},a={visuallyHidden:"visually-hidden",checkbox:"checkbox",checkboxController:"checkbox__controller",checkboxEmulator:"checkbox__emulator",todoItem:"todo__todo-item todo-item",todoItemCheckbox:"todo-item__checkbox",todoItemLabel:"todo-item__label",todoItemLabelCompleted:"todo-item__label--completed",todoItemLabelEditable:"todo-item__label--editable",deleteTaskButton:"todo-item__delete-task-button"},B=document.querySelector(s.todoFooter),j=document.querySelector(s.todoItemsCount),w=document.querySelector(s.todoItemsLabel),q=document.querySelector(s.todoItemsLeft),y=document.querySelector(s.removeCompletedTasksButton),D=t=>{let e=null,o=null;switch(!0){case(t%10===1&&t!==11):e="задача",o="осталась";break;case(t%100===11||t%100===12||t%100===13):e="задач",o="осталось";break;case(t%10===2||t%10===3||t%10===4):e="задачи",o="осталось";break;default:e="задач",o="осталось"}return[e,o]},u=()=>{const t=r(),e=t.filter(({isDone:l})=>!l).length,[o,n]=D(e);j.innerHTML=e,w.innerHTML=o,q.innerHTML=n,_(t),t.length===0&&B.classList.add(a.visuallyHidden)},_=t=>{t.filter(({isDone:o})=>o).length>0?y.classList.remove(a.visuallyHidden):y.classList.add(a.visuallyHidden)},k="snp-todo",r=()=>JSON.parse(localStorage.getItem(k)),N=t=>{const o=[...r()??[],t];localStorage.setItem(k,JSON.stringify(o))},F=t=>{const o=r().filter(n=>n.id!==t);localStorage.setItem(k,JSON.stringify(o))},p=(t,e={})=>{const{isDone:o,label:n}=e,c=r().map(d=>d.id===t?{...d,...o!==void 0&&{isDone:o},...n!==void 0&&{label:n}}:d);localStorage.setItem(k,JSON.stringify(c))},O=()=>{const e=r().filter(o=>!o.isDone);localStorage.setItem(k,JSON.stringify(e))},I=document.querySelector(s.toggleComplete),L=document.querySelector(s.todoList),E=document.querySelector(s.todoInput),H=document.querySelector(s.todoFooter),h=t=>{const{id:e,label:o,isDone:n}=t,l=document.createElement("li");l.className=a.todoItem,l.dataset.jsTodoItem="";const c=document.createElement("label");c.classList.add(a.todoItemCheckbox,a.checkbox);const d=document.createElement("input"),C=document.createElement("span");d.className=a.checkboxController,d.type="checkbox",d.id=`${e}`,d.checked=n,d.dataset.jsTodoItemCheckbox="",C.className=a.checkboxEmulator,c.append(d,C);const b=document.createElement("span");b.className=`${a.todoItemLabel} ${n&&a.todoItemLabelCompleted}`,b.textContent=o,b.dataset.jsTodoItemLabel="";const m=document.createElement("button");m.className=a.deleteTaskButton,m.type="button",m.title="Удалить задачу",m.ariaLabel="Удалить задачу",m.dataset.jsDeleteTaskButton="",l.append(c,b,m),L.prepend(l)},S=(t,e)=>{e?t.classList.add(a.todoItemLabelCompleted):t.classList.remove(a.todoItemLabelCompleted)},x=()=>{L.classList.remove(a.visuallyHidden),H.classList.remove(a.visuallyHidden)},i=t=>{const e=r();if(e!==null){if(x(),L.innerHTML="",!t){e.forEach(o=>h(o));return}if(t==="active"){e.filter(({isDone:n})=>!n).forEach(n=>h(n));return}t==="completed"&&e.filter(({isDone:n})=>n).forEach(n=>h(n))}},A=t=>{t.preventDefault();const e=E.value.trim();if(!e){alert("Пустое имя задачи.");return}const o={id:crypto?.randomUUID()??new Date,label:e,isDone:!1};E.value="",N(o),h(o),u(),L.classList.contains(a.visuallyHidden)&&x(),i(),I.checked=!1},T=()=>{const t=r();let e=!0;for(const o of t)if(!o.isDone){e=!1;break}I.checked=e},M=t=>{const{checked:e}=t,o=document.querySelectorAll(s.todoItemLabel),n=document.querySelectorAll(s.todoItemCheckbox),l=r();o.forEach(c=>S(c,e)),n.forEach(c=>c.checked=e),l.forEach(({id:c})=>{p(c,{isDone:e})}),u()},J=t=>{const o=t.closest(s.todoItem).querySelector(s.todoItemLabel),{id:n,checked:l}=t;p(n,{isDone:l}),S(o,l),u(),T()},P=t=>{t.contentEditable=!0,t.classList.add(a.todoItemLabelEditable)},$=t=>{const o=t.closest(s.todoItem).querySelector(s.todoItemCheckbox)?.id,n=t.innerText;t.innerText=n.replace(/\s+/g," ").trim(),t.contentEditable=!1,t.classList.remove(a.todoItemLabelEditable),p(o,{label:n||""})},U=t=>{const e=t.closest(s.todoItem),o=e.querySelector(s.todoItemCheckbox)?.id,n=e.querySelector(s.todoItemLabel)?.textContent;confirm(`Удалить задачу "${n}"?`)&&(e.remove(),F(o),u(),T())},K=()=>{confirm("Удалить выполненные задачи?")&&(O(),i(),u(),I.checked=!1)},V=document.querySelector(s.todoForm);let f=0,v;const g=400,R=t=>{const e=Date.now();if(e-f<g){clearTimeout(v),P(t),f=0;return}f=e,v=setTimeout(()=>{f=0},g)},W=()=>{document.addEventListener("DOMContentLoaded",()=>{i(),u(),T()}),document.addEventListener("click",t=>{const{target:e}=t;if(e.matches(s.todoItemLabel)||document.querySelectorAll(s.todoItemLabel).forEach(o=>{o.classList.remove(a.todoItemLabelEditable)}),e.matches(s.toggleComplete))return M(e);if(e.matches(s.todoItemCheckbox))return J(e);if(e.matches(s.todoItemLabel))return R(e);if(e.matches(s.deleteTaskButton))return U(e);if(e.matches(s.showAllTasksButton))return i();if(e.matches(s.showActiveTasksButton))return i("active");if(e.matches(s.showCompletedTasksButton))return i("completed");if(e.matches(s.removeCompletedTasksButton))return K()}),document.addEventListener("blur",t=>{const{target:e}=t;if(e.matches(s.todoItemLabel))return $(e)},!0),V.addEventListener("submit",A)};W();
